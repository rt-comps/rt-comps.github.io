let[compName,compPath]=rtlib.parseCompURL(import.meta.url);customElements.define(compName,class extends rtBC.RTBaseClass{#_sR;constructor(){super(),this.#_sR=this.attachShadow({mode:"open"}),this.#_sR.append(this.$getTemplate()),this.getMenu(),this.#_sR.querySelector("#x img").src=compPath+"/img/close-wht.png",this.addEventListener("neworder",e=>this.dispatchOrder(e)),this.#_sR.querySelector("#x").addEventListener("click",()=>this.#_sR.querySelector("dialog").close())}connectedCallback(){}async getMenu(){var e=this.#_sR.querySelector("dialog"),t=this.$attr("datafile");if(null!==t&&""!==t){t=compPath+"/"+t;try{var a=await fetch(t);if(!a.ok)throw`Failed to load ${t} with status `+a.status;var r=await a.text(),s=document.createRange().createContextualFragment(r);e.appendChild(s)}catch(e){console.warn(e)}}else{t=document.createRange().createContextualFragment('<h1 style="color: red;">datafile attribute not provided</h1>');e.appendChild(t)}}dispatchOrder(e){e instanceof Event&&e.stopPropagation(),e.detail&&(e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:"item-line",order:e.detail.order,details:e.detail.person})},fetch("https://roads-technology.com/rtform/sendmail.php",e).then(e=>{if(e.ok)return e.text()}).then(e=>{"OK"===e.slice(-2)&&"NOK"!==e.slice(-3)?this.#_sR.querySelector("rt-orderform").accepted():(alert("Order submission failed"),console.warn(e))}))}show(){this.#_sR.querySelector("dialog").showModal()}});
const[compName,compPath]=rtlib.parseURL(import.meta.url);customElements.define(compName,class extends rtBC.RTBaseClass{#_sR;constructor(){super(),this.#_sR=this.attachShadow({mode:"open"}),this.#_sR.append(this.$getTemplate()),this.getMenu(),this.#_sR.querySelector("#x img").src=compPath+"/img/close-wht.png",this.addEventListener("neworder",e=>this.dispatchOrder(e)),this.#_sR.querySelector("#x").addEventListener("click",()=>this.#_sR.querySelector("dialog").close())}connectedCallback(){}getMenu(){let t=this.#_sR.querySelector("dialog");if(this.hasAttribute("datafile")&&this.getAttribute("datafile")){const a=compPath+"/"+this.getAttribute("datafile");try{fetch(a).then(e=>{if(e.ok)return e.text();throw`Failed to load ${a} with status `+e.status}).then(e=>{e=document.createRange().createContextualFragment(e);t.appendChild(e)})}catch(e){console.warn(e)}}else{var e=document.createRange().createContextualFragment('<h1 style="color: red;">datafile attribute not provided</h1>');t.appendChild(e)}}dispatchOrder(e){e&&e.stopPropagation(),e.detail&&(e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:"item-line",order:e.detail.order,details:e.detail.person})},fetch("https://roads-technology.com/rtform/sendmail.php",e).then(e=>{if(e.ok)return e.text()}).then(e=>{"OK"===e.slice(-2)&&"NOK"!==e.slice(-3)?this.#_sR.querySelector("rt-orderform").accepted():(alert("Order submission failed"),console.warn(e))}))}show(){this.#_sR.querySelector("dialog").showModal()}});
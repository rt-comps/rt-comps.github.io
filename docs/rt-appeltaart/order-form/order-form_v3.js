const[compName]=rt.parseURL(import.meta.url);customElements.define(compName,class extends rtBase.RTBaseClass{constructor(){const t=super().attachShadow({mode:"open"});t.append(this.$getTemplate()),this.addEventListener("updatemenu",t=>this.updateData(t)),t.querySelector("#item-data-container").addEventListener("updatecount",t=>this.displayAddButton(t)),t.querySelector("#cart").addEventListener("updatecount",t=>this.displayOrderButton(t)),t.querySelector("#add-but").addEventListener("click",()=>this.addToCart()),t.querySelector("#place-but").addEventListener("click",()=>this.dispatchOrder())}connectedCallback(){this.processMenuItems(),this.style.display="inline-block"}processMenuItems(){const t=this.querySelector("form-config span#imgpath").innerHTML,e=[...this.querySelectorAll("item-data")];this.append(...e.map(e=>{let r={id:e.id,slot:"menu-items"},i=e.querySelector("img");return i&&(r.bgimg=`${t}/${i.getAttribute("file")}`),this.$createElement({tag:"menu-item",innerHTML:`${e.querySelector("item-title").innerHTML}`,attrs:r})}))}updateData(t){this.querySelectorAll("item-data").forEach(t=>{t.removeAttribute("slot")});const e=this.shadowRoot.querySelector("#add-but");e.style.display="none",t&&(t.stopPropagation(),t.detail.id&&(this.querySelector(`item-data#${t.detail.id}`).setAttribute("slot","active-data"),e.removeAttribute("style")),this.displayAddButton())}displayAddButton(t){t&&t.stopPropagation();const e=this.shadowRoot.querySelector("#item-data-container"),r=e.querySelector("#add-but");0===this.querySelectorAll("item-data[slot] item-line[count]").length?(r.style.backgroundColor="rgb(128, 128, 128)",r.innerHTML="Close"):(r.removeAttribute("style"),r.innerHTML="Add To Order")}displayOrderButton(t){t&&t.stopPropagation();const e=this.shadowRoot.querySelector("#cart"),r=e.querySelector("#place-but");0===this.querySelectorAll('line-item[slot="cart"][count]').length?r.style.display="none":r.removeAttribute("style")}addToCart(){const t=[...this.querySelectorAll('[slot="active-data"] item-line[count]')];t.length>0&&(this.append(...t.map(t=>{const e=`${t.parentNode.parentNode.querySelector("item-title").innerHTML} - ${t.parentNode.getAttribute("value")} - ${t.innerHTML}`,r=t.getAttribute("count"),i=this.$createElement({tag:"line-item",innerHTML:e,attrs:{slot:"cart",count:r,unit:t.getAttribute("prijs")}});return t.updateCount({detail:{change:0-parseInt(r)}}),i})),this.displayAddButton(),this.displayOrderButton()),this.updateData()}dispatchOrder(){const t=[...this.querySelectorAll("line-item[count]")];t.length>0&&this.$dispatch({name:"neworder",detail:{orderdetails:t.map(t=>{const e={item:t.innerHTML,count:parseInt(t.shadowRoot.querySelector("#count").innerHTML),unit:t.getAttribute("unit")};return t.remove(),e})}}),this.displayOrderButton()}});
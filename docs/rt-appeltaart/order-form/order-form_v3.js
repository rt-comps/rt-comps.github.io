const[compName]=rt.parseURL(import.meta.url);customElements.define(compName,class extends rtBase.RTBaseClass{constructor(){const t=super().attachShadow({mode:"open"});t.append(this.$getTemplate()),this.addEventListener("updatemenu",t=>this.updateData(t));const e=t.querySelector("#item-data-container");e.addEventListener("updatecount",t=>this.enableButton(e,t));const r=t.querySelector("#cart");r.addEventListener("updatecount",t=>this.enableButton(r,t)),t.querySelector("#add-items-button").addEventListener("click",()=>this.addToCart()),t.querySelector("#place-order-button").addEventListener("click",()=>this.dispatchOrder())}connectedCallback(){this.processMenuItems(),this.style.display="inline-block"}processMenuItems(){const t=this.querySelector("form-config span#imgpath").innerHTML,e=[...this.querySelectorAll("item-data")];this.append(...e.map(e=>{let r={id:e.id,slot:"menu-items"},a=e.querySelector("img");return a&&(r.bgimg=`${t}/${a.getAttribute("file")}`),this.$createElement({tag:"menu-item",innerHTML:`${e.querySelector("item-title").innerHTML}`,attrs:r})}))}updateData(t){this.querySelectorAll("item-data").forEach(t=>{t.removeAttribute("slot")});const e=this.shadowRoot.querySelector("#add-items-button");e.style.display="none",t&&(t.stopPropagation(),t.detail.id&&(this.querySelector(`item-data#${t.detail.id}`).setAttribute("slot","active-data"),e.style.display=""),this.enableButton(this.shadowRoot.querySelector("#item-data-container"),t))}enableButton(t,e){e&&e.stopPropagation();let r="",a="";switch(t.id){case"item-data-container":r="item-data[slot] item-line[count]",a=t.querySelector("#add-items-button");break;case"cart":r='line-item[slot="cart"][count]',a=t.querySelector("#place-order-button");break;default:return}0===this.querySelectorAll(r).length?a.style.backgroundColor="rgb(128, 128, 128)":a.removeAttribute("style")}addToCart(){if(this.shadowRoot.querySelector("#add-items-button").hasAttribute("style"))return;const t=[...this.querySelectorAll('[slot="active-data"] item-line[count]')];this.append(...t.map(t=>{const e=`${t.parentNode.parentNode.querySelector("item-title").innerHTML} - ${t.parentNode.getAttribute("value")} - ${t.innerHTML}`,r=t.getAttribute("count"),a=this.$createElement({tag:"line-item",innerHTML:e,attrs:{slot:"cart",count:r,unit:t.getAttribute("prijs")}});return t.updateCount({detail:{change:0-parseInt(r)}}),a})),this.enableButton(this.shadowRoot.querySelector("#item-data-container")),this.enableButton(this.shadowRoot.querySelector("#cart")),this.updateData()}dispatchOrder(){if(this.shadowRoot.querySelector("#place-order-button").hasAttribute("style"))return;this.updateData();const t=[...this.querySelectorAll("line-item[count]")];t.length>0&&this.$dispatch({name:"neworder",detail:{orderdetails:t.map(t=>{const e={item:t.innerHTML,count:parseInt(t.shadowRoot.querySelector("#count").innerHTML),unit:t.getAttribute("unit")};return t.remove(),e})}}),this.enableButton(this.shadowRoot.querySelector("#cart"))}});